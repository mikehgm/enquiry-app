<div class="card shadow-sm mb-4">
  <div class="card-body">
    <h5 class="card-title mb-3">ðŸ’Ž Loyal Clients</h5>

    <div *ngIf="loading" class="text-center text-muted py-4">
      <i class="fas fa-spinner fa-spin me-1"></i> Loading...
    </div>

    <div *ngIf="!loading && clients.length > 0" class="table-responsive">
      <table class="table table-striped align-middle">
        <thead>
          <tr>
            <th>Name</th>
            <th>Email</th>
            <th>Phone</th>
            <th class="text-center">Total</th>
            <th class="text-end">Last Interaction</th>
            <th class="text-end">PromociÃ³n</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let c of clients">
            <td>{{ c.name }}</td>
            <td>{{ c.email }}</td>
            <td>{{ c.phone }}</td>
            <td class="text-center"><span class="badge bg-primary">{{ c.totalEnquiries }}</span></td>
            <td class="text-end">{{ c.lastInteraction | date:'shortDate' }}</td>
            <td class="text-end">
              <button class="btn btn-outline-primary btn-sm" (click)="openPromotionModal(c)">
                <i class="fas fa-gift me-1"></i> Enviar
              </button>
            </td>
          </tr>
        </tbody>
      </table>
    </div>

    <div *ngIf="!loading && clients.length === 0" class="text-center text-muted">
      No loyal clients found in this period.
    </div>
  </div>
</div>

<app-send-promotion-modal
  [clientName]="selectedClient?.name || ''"
  [email]="selectedClient?.email || ''"
  [phone]="selectedClient?.phone || ''"
  (send)="onPromotionSend($event)">
</app-send-promotion-modal>
